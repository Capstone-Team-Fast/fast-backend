\hypertarget{namespacewheel_1_1macosx__libfile}{}\doxysection{wheel.\+macosx\+\_\+libfile Namespace Reference}
\label{namespacewheel_1_1macosx__libfile}\index{wheel.macosx\_libfile@{wheel.macosx\_libfile}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a7e266d63eddced13840dc7187c7b4a0c}\label{namespacewheel_1_1macosx__libfile_a7e266d63eddced13840dc7187c7b4a0c}} 
def {\bfseries swap32} (x)
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a558140e8275726186090473cca428d7d}\label{namespacewheel_1_1macosx__libfile_a558140e8275726186090473cca428d7d}} 
def {\bfseries get\+\_\+base\+\_\+class\+\_\+and\+\_\+magic\+\_\+number} (lib\+\_\+file, seek=None)
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a8289d6e5cf9a06c014ae5091f64cafea}\label{namespacewheel_1_1macosx__libfile_a8289d6e5cf9a06c014ae5091f64cafea}} 
def {\bfseries read\+\_\+data} (struct\+\_\+class, lib\+\_\+file)
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a170e93b2ff4578e532d3863325e0c138}\label{namespacewheel_1_1macosx__libfile_a170e93b2ff4578e532d3863325e0c138}} 
def {\bfseries extract\+\_\+macosx\+\_\+min\+\_\+system\+\_\+version} (path\+\_\+to\+\_\+lib)
\item 
def \mbox{\hyperlink{namespacewheel_1_1macosx__libfile_a81a1c24ff2678ffe61fa52733812b894}{read\+\_\+mach\+\_\+header}} (lib\+\_\+file, seek=None)
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_abdfb08851e34b7e57d43dc01addf40ce}\label{namespacewheel_1_1macosx__libfile_abdfb08851e34b7e57d43dc01addf40ce}} 
def {\bfseries parse\+\_\+version} (version)
\item 
def \mbox{\hyperlink{namespacewheel_1_1macosx__libfile_af3877aa7396b5d34ed3f151aeb08c6f7}{calculate\+\_\+macosx\+\_\+platform\+\_\+tag}} (archive\+\_\+root, platform\+\_\+tag)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a1ca60bd35dbb61d62705fb5fdf84edab}\label{namespacewheel_1_1macosx__libfile_a1ca60bd35dbb61d62705fb5fdf84edab}} 
int {\bfseries FAT\+\_\+\+MAGIC} = 0xcafebabe
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a865fa60d6914d7f27d2378abf77b1f29}\label{namespacewheel_1_1macosx__libfile_a865fa60d6914d7f27d2378abf77b1f29}} 
int {\bfseries FAT\+\_\+\+CIGAM} = 0xbebafeca
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_aea95e8717c1abc09e53307522003b2f7}\label{namespacewheel_1_1macosx__libfile_aea95e8717c1abc09e53307522003b2f7}} 
int {\bfseries FAT\+\_\+\+MAGIC\+\_\+64} = 0xcafebabf
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a67f87ba365bb02b81abf63a386abaa5b}\label{namespacewheel_1_1macosx__libfile_a67f87ba365bb02b81abf63a386abaa5b}} 
int {\bfseries FAT\+\_\+\+CIGAM\+\_\+64} = 0xbfbafeca
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a4da385cd9280d52f8ff743a725ac4488}\label{namespacewheel_1_1macosx__libfile_a4da385cd9280d52f8ff743a725ac4488}} 
int {\bfseries MH\+\_\+\+MAGIC} = 0xfeedface
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a9bca912ca89ec33f695e5228076b4431}\label{namespacewheel_1_1macosx__libfile_a9bca912ca89ec33f695e5228076b4431}} 
int {\bfseries MH\+\_\+\+CIGAM} = 0xcefaedfe
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a67c968685b0ccedd60960ece40e494f9}\label{namespacewheel_1_1macosx__libfile_a67c968685b0ccedd60960ece40e494f9}} 
int {\bfseries MH\+\_\+\+MAGIC\+\_\+64} = 0xfeedfacf
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a7a6cb43c8096e58081dc3903f506464b}\label{namespacewheel_1_1macosx__libfile_a7a6cb43c8096e58081dc3903f506464b}} 
int {\bfseries MH\+\_\+\+CIGAM\+\_\+64} = 0xcffaedfe
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a2a24e4772a362e4a58f7990406ec59ba}\label{namespacewheel_1_1macosx__libfile_a2a24e4772a362e4a58f7990406ec59ba}} 
int {\bfseries LC\+\_\+\+VERSION\+\_\+\+MIN\+\_\+\+MACOSX} = 0x24
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a4e070fcf166207a5fa2dd31360d26ce8}\label{namespacewheel_1_1macosx__libfile_a4e070fcf166207a5fa2dd31360d26ce8}} 
int {\bfseries LC\+\_\+\+BUILD\+\_\+\+VERSION} = 0x32
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a554aba632ee86b64fd07e08aaba48999}\label{namespacewheel_1_1macosx__libfile_a554aba632ee86b64fd07e08aaba48999}} 
int {\bfseries CPU\+\_\+\+TYPE\+\_\+\+ARM64} = 0x0100000c
\item 
list \mbox{\hyperlink{namespacewheel_1_1macosx__libfile_a404b87c8ee58cf723995149213240804}{mach\+\_\+header\+\_\+fields}}
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a1d6b328d2c49b50a19d35a829745438b}\label{namespacewheel_1_1macosx__libfile_a1d6b328d2c49b50a19d35a829745438b}} 
list {\bfseries mach\+\_\+header\+\_\+fields\+\_\+64} = mach\+\_\+header\+\_\+fields + \mbox{[}(\char`\"{}reserved\char`\"{}, ctypes.\+c\+\_\+uint32)\mbox{]}
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_aab802bf74bb654d2723ecf0e0a761923}\label{namespacewheel_1_1macosx__libfile_aab802bf74bb654d2723ecf0e0a761923}} 
list {\bfseries fat\+\_\+header\+\_\+fields} = \mbox{[}(\char`\"{}magic\char`\"{}, ctypes.\+c\+\_\+uint32), (\char`\"{}nfat\+\_\+arch\char`\"{}, ctypes.\+c\+\_\+uint32)\mbox{]}
\item 
list \mbox{\hyperlink{namespacewheel_1_1macosx__libfile_adfbd0d3da94de58dc005553d6517b55a}{fat\+\_\+arch\+\_\+fields}}
\item 
list \mbox{\hyperlink{namespacewheel_1_1macosx__libfile_acf93e8abb49de445679f584569fcfe93}{fat\+\_\+arch\+\_\+64\+\_\+fields}}
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a80149cf035913fc371a530d6443de6df}\label{namespacewheel_1_1macosx__libfile_a80149cf035913fc371a530d6443de6df}} 
list {\bfseries segment\+\_\+base\+\_\+fields} = \mbox{[}(\char`\"{}cmd\char`\"{}, ctypes.\+c\+\_\+uint32), (\char`\"{}cmdsize\char`\"{}, ctypes.\+c\+\_\+uint32)\mbox{]}
\item 
list \mbox{\hyperlink{namespacewheel_1_1macosx__libfile_acc61801cd2ec2cf290b6691e44c3ee25}{segment\+\_\+command\+\_\+fields}}
\item 
list \mbox{\hyperlink{namespacewheel_1_1macosx__libfile_ad569756f464a42d1504d6b1fa3c5476b}{segment\+\_\+command\+\_\+fields\+\_\+64}}
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_afd2dc38176eb101467438951be5f16a6}\label{namespacewheel_1_1macosx__libfile_afd2dc38176eb101467438951be5f16a6}} 
list {\bfseries version\+\_\+min\+\_\+command\+\_\+fields} = segment\+\_\+base\+\_\+fields + \textbackslash{}
\item 
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a08aa1ac0a4a3a140732b6ccb49658e31}\label{namespacewheel_1_1macosx__libfile_a08aa1ac0a4a3a140732b6ccb49658e31}} 
list {\bfseries build\+\_\+version\+\_\+command\+\_\+fields} = segment\+\_\+base\+\_\+fields + \textbackslash{}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}This module contains function to analyse dynamic library
headers to extract system information

Currently only for MacOSX

Library file on macosx system starts with Mach-O or Fat field.
This can be distinguish by first 32 bites and it is called magic number.
Proper value of magic number is with suffix _MAGIC. Suffix _CIGAM means
reversed bytes order.
Both fields can occur in two types: 32 and 64 bytes.

FAT field inform that this library contains few version of library
(typically for different types version). It contains
information where Mach-O headers starts.

Each section started with Mach-O header contains one library
(So if file starts with this field it contains only one version).

After filed Mach-O there are section fields.
Each of them starts with two fields:
cmd - magic number for this command
cmdsize - total size occupied by this section information.

In this case only sections LC_VERSION_MIN_MACOSX (for macosx 10.13 and earlier)
and LC_BUILD_VERSION (for macosx 10.14 and newer) are interesting,
because them contains information about minimal system version.

Important remarks:
- For fat files this implementation looks for maximum number version.
  It not check if it is 32 or 64 and do not compare it with currently builded package.
  So it is possible to false report higher version that needed.
- All structures signatures are taken form macosx header files.
- I think that binary format will be more stable than `otool` output.
  and if apple introduce some changes both implementation will need to be updated.
- The system compile will set the deployment target no lower than
  11.0 for arm64 builds. For "Universal 2" builds use the x86_64 deployment
  target when the arm64 target is 11.0.
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_af3877aa7396b5d34ed3f151aeb08c6f7}\label{namespacewheel_1_1macosx__libfile_af3877aa7396b5d34ed3f151aeb08c6f7}} 
\index{wheel.macosx\_libfile@{wheel.macosx\_libfile}!calculate\_macosx\_platform\_tag@{calculate\_macosx\_platform\_tag}}
\index{calculate\_macosx\_platform\_tag@{calculate\_macosx\_platform\_tag}!wheel.macosx\_libfile@{wheel.macosx\_libfile}}
\doxysubsubsection{\texorpdfstring{calculate\_macosx\_platform\_tag()}{calculate\_macosx\_platform\_tag()}}
{\footnotesize\ttfamily def wheel.\+macosx\+\_\+libfile.\+calculate\+\_\+macosx\+\_\+platform\+\_\+tag (\begin{DoxyParamCaption}\item[{}]{archive\+\_\+root,  }\item[{}]{platform\+\_\+tag }\end{DoxyParamCaption})}

\begin{DoxyVerb}Calculate proper macosx platform tag basing on files which are included to wheel

Example platform tag `macosx-10.14-x86_64`
\end{DoxyVerb}
 \mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a81a1c24ff2678ffe61fa52733812b894}\label{namespacewheel_1_1macosx__libfile_a81a1c24ff2678ffe61fa52733812b894}} 
\index{wheel.macosx\_libfile@{wheel.macosx\_libfile}!read\_mach\_header@{read\_mach\_header}}
\index{read\_mach\_header@{read\_mach\_header}!wheel.macosx\_libfile@{wheel.macosx\_libfile}}
\doxysubsubsection{\texorpdfstring{read\_mach\_header()}{read\_mach\_header()}}
{\footnotesize\ttfamily def wheel.\+macosx\+\_\+libfile.\+read\+\_\+mach\+\_\+header (\begin{DoxyParamCaption}\item[{}]{lib\+\_\+file,  }\item[{}]{seek = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}This funcition parse mach-O header and extract
information about minimal system version

:param lib_file: reference to opened library file with pointer
\end{DoxyVerb}
 

\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_acf93e8abb49de445679f584569fcfe93}\label{namespacewheel_1_1macosx__libfile_acf93e8abb49de445679f584569fcfe93}} 
\index{wheel.macosx\_libfile@{wheel.macosx\_libfile}!fat\_arch\_64\_fields@{fat\_arch\_64\_fields}}
\index{fat\_arch\_64\_fields@{fat\_arch\_64\_fields}!wheel.macosx\_libfile@{wheel.macosx\_libfile}}
\doxysubsubsection{\texorpdfstring{fat\_arch\_64\_fields}{fat\_arch\_64\_fields}}
{\footnotesize\ttfamily list wheel.\+macosx\+\_\+libfile.\+fat\+\_\+arch\+\_\+64\+\_\+fields}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 =  [}
\DoxyCodeLine{2     (\textcolor{stringliteral}{"{}cputype"{}}, ctypes.c\_int), (\textcolor{stringliteral}{"{}cpusubtype"{}}, ctypes.c\_int),}
\DoxyCodeLine{3     (\textcolor{stringliteral}{"{}offset"{}}, ctypes.c\_uint64), (\textcolor{stringliteral}{"{}size"{}}, ctypes.c\_uint64),}
\DoxyCodeLine{4     (\textcolor{stringliteral}{"{}align"{}}, ctypes.c\_uint32), (\textcolor{stringliteral}{"{}reserved"{}}, ctypes.c\_uint32)}
\DoxyCodeLine{5 ]}

\end{DoxyCode}
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_adfbd0d3da94de58dc005553d6517b55a}\label{namespacewheel_1_1macosx__libfile_adfbd0d3da94de58dc005553d6517b55a}} 
\index{wheel.macosx\_libfile@{wheel.macosx\_libfile}!fat\_arch\_fields@{fat\_arch\_fields}}
\index{fat\_arch\_fields@{fat\_arch\_fields}!wheel.macosx\_libfile@{wheel.macosx\_libfile}}
\doxysubsubsection{\texorpdfstring{fat\_arch\_fields}{fat\_arch\_fields}}
{\footnotesize\ttfamily list wheel.\+macosx\+\_\+libfile.\+fat\+\_\+arch\+\_\+fields}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 =  [}
\DoxyCodeLine{2     (\textcolor{stringliteral}{"{}cputype"{}}, ctypes.c\_int), (\textcolor{stringliteral}{"{}cpusubtype"{}}, ctypes.c\_int),}
\DoxyCodeLine{3     (\textcolor{stringliteral}{"{}offset"{}}, ctypes.c\_uint32), (\textcolor{stringliteral}{"{}size"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{4     (\textcolor{stringliteral}{"{}align"{}}, ctypes.c\_uint32)}
\DoxyCodeLine{5 ]}

\end{DoxyCode}
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_a404b87c8ee58cf723995149213240804}\label{namespacewheel_1_1macosx__libfile_a404b87c8ee58cf723995149213240804}} 
\index{wheel.macosx\_libfile@{wheel.macosx\_libfile}!mach\_header\_fields@{mach\_header\_fields}}
\index{mach\_header\_fields@{mach\_header\_fields}!wheel.macosx\_libfile@{wheel.macosx\_libfile}}
\doxysubsubsection{\texorpdfstring{mach\_header\_fields}{mach\_header\_fields}}
{\footnotesize\ttfamily list wheel.\+macosx\+\_\+libfile.\+mach\+\_\+header\+\_\+fields}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 =  [}
\DoxyCodeLine{2         (\textcolor{stringliteral}{"{}magic"{}}, ctypes.c\_uint32), (\textcolor{stringliteral}{"{}cputype"{}}, ctypes.c\_int),}
\DoxyCodeLine{3         (\textcolor{stringliteral}{"{}cpusubtype"{}}, ctypes.c\_int), (\textcolor{stringliteral}{"{}filetype"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{4         (\textcolor{stringliteral}{"{}ncmds"{}}, ctypes.c\_uint32), (\textcolor{stringliteral}{"{}sizeofcmds"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{5         (\textcolor{stringliteral}{"{}flags"{}}, ctypes.c\_uint32)}
\DoxyCodeLine{6     ]}

\end{DoxyCode}
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_acc61801cd2ec2cf290b6691e44c3ee25}\label{namespacewheel_1_1macosx__libfile_acc61801cd2ec2cf290b6691e44c3ee25}} 
\index{wheel.macosx\_libfile@{wheel.macosx\_libfile}!segment\_command\_fields@{segment\_command\_fields}}
\index{segment\_command\_fields@{segment\_command\_fields}!wheel.macosx\_libfile@{wheel.macosx\_libfile}}
\doxysubsubsection{\texorpdfstring{segment\_command\_fields}{segment\_command\_fields}}
{\footnotesize\ttfamily list wheel.\+macosx\+\_\+libfile.\+segment\+\_\+command\+\_\+fields}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 =  [}
\DoxyCodeLine{2     (\textcolor{stringliteral}{"{}cmd"{}}, ctypes.c\_uint32), (\textcolor{stringliteral}{"{}cmdsize"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{3     (\textcolor{stringliteral}{"{}segname"{}}, ctypes.c\_char * 16), (\textcolor{stringliteral}{"{}vmaddr"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{4     (\textcolor{stringliteral}{"{}vmsize"{}}, ctypes.c\_uint32), (\textcolor{stringliteral}{"{}fileoff"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{5     (\textcolor{stringliteral}{"{}filesize"{}}, ctypes.c\_uint32), (\textcolor{stringliteral}{"{}maxprot"{}}, ctypes.c\_int),}
\DoxyCodeLine{6     (\textcolor{stringliteral}{"{}initprot"{}}, ctypes.c\_int), (\textcolor{stringliteral}{"{}nsects"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{7     (\textcolor{stringliteral}{"{}flags"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{8     ]}

\end{DoxyCode}
\mbox{\Hypertarget{namespacewheel_1_1macosx__libfile_ad569756f464a42d1504d6b1fa3c5476b}\label{namespacewheel_1_1macosx__libfile_ad569756f464a42d1504d6b1fa3c5476b}} 
\index{wheel.macosx\_libfile@{wheel.macosx\_libfile}!segment\_command\_fields\_64@{segment\_command\_fields\_64}}
\index{segment\_command\_fields\_64@{segment\_command\_fields\_64}!wheel.macosx\_libfile@{wheel.macosx\_libfile}}
\doxysubsubsection{\texorpdfstring{segment\_command\_fields\_64}{segment\_command\_fields\_64}}
{\footnotesize\ttfamily list wheel.\+macosx\+\_\+libfile.\+segment\+\_\+command\+\_\+fields\+\_\+64}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 =  [}
\DoxyCodeLine{2     (\textcolor{stringliteral}{"{}cmd"{}}, ctypes.c\_uint32), (\textcolor{stringliteral}{"{}cmdsize"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{3     (\textcolor{stringliteral}{"{}segname"{}}, ctypes.c\_char * 16), (\textcolor{stringliteral}{"{}vmaddr"{}}, ctypes.c\_uint64),}
\DoxyCodeLine{4     (\textcolor{stringliteral}{"{}vmsize"{}}, ctypes.c\_uint64), (\textcolor{stringliteral}{"{}fileoff"{}}, ctypes.c\_uint64),}
\DoxyCodeLine{5     (\textcolor{stringliteral}{"{}filesize"{}}, ctypes.c\_uint64), (\textcolor{stringliteral}{"{}maxprot"{}}, ctypes.c\_int),}
\DoxyCodeLine{6     (\textcolor{stringliteral}{"{}initprot"{}}, ctypes.c\_int), (\textcolor{stringliteral}{"{}nsects"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{7     (\textcolor{stringliteral}{"{}flags"{}}, ctypes.c\_uint32),}
\DoxyCodeLine{8     ]}

\end{DoxyCode}
